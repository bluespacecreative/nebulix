---
import { Picture, BackgroundPicture } from "astro-imagetools/components";

import HeroContent from "@components/hero/HeroContent.astro";

const {
  title,
  thumbnail,
  hero_buttons,
  intro,
  tag,
  filter,
  filters,
  filter_type,
  style,
  pubDate,
  base_url,
} = Astro.props;

const { slug } = Astro.params;
---

<div
  class={`hero relative overflow-hidden nebulix-parallax ${
    style.hero_surface || "surface-dark"
  } ${style.hero_class || ""}`}
  transition:name={`hero_${slug || Math.random()}`}
  id="header"
>
  {
    thumbnail && (
      <div class="media parallax w-full">
        <BackgroundPicture
          attributes={{
            picture: {
              class: "h-auto",
              style: `opacity: ${style.hero_image_opacity || 0.7}`,
            },
          }}
          src={thumbnail}
          width={1920}
          height={1080}
          ar={1920 / 1080}
          alt={title}
          breakpoints={[1000, 1280, 1440, 1536, 1920]}
          sizes="100vw"
          loading="eager"
          layout="fill"
          position="entropy"
          artDirectives={[
            {
              media: "(max-width: 500px)",
              ar: 1920 / 1080,
              src: thumbnail,
              breakpoints: [320, 360, 390, 412, 500, 601, 768, 1024, 1200],
            },
            {
              media: "(max-width: 1000px)",
              ar: 1920 / 1080,
              src: thumbnail,
              breakpoints: [500, 601, 768, 820, 962, 1280, 1440, 1536, 1920],
            },
          ]}
        >
          <HeroContent
            {hero_buttons}
            {pubDate}
            {base_url}
            {intro}
            {tag}
            {filter}
            {filters}
            {filter_type}
          />
        </BackgroundPicture>
      </div>
    )
  }
</div>

<style>
  .hero-no {
    @screen sm {
      min-height: calc(100svh - 4rem);
    }
  }
  .media-no {
    @screen sm {
      max-height: calc(100svh - 4rem);
    }
  }
</style>
